---
layout: entry

conf:
  type: parameter
  subtitle:
    en: Parameter
    es: Topico
---
{% if page.lang %}
  {% assign language = page.lang %}
{% elsif site.collections[page.collection].lang %}
  {% assign language = site.collections[page.collection].lang %}
{% endif %}

<div class="row--contained">

  <div class="col--main">
    <h2>Description</h2>
    {{ content }}
  </div>

  <div class="col--sec">
    {% case language %}
    {% when 'en' %}
      <dl class="stats-list">
        <dt>Weight</dt>
        <dd>40<sup>%</sup></dd>
        <dt>Highest score <small>(Brazil)</small></dt>
        <dd>2.25</dd>
        <dt>Lowest score <small>(Botswana)</small></dt>
        <dd>0.83</dd>
      </dl>

    {% when 'es' %}

      <dl class="stats-list">
        <dt>Weight</dt>
        <dd>40<sup>%</sup></dd>
        <dt>Highest score <small>(Brazil)</small></dt>
        <dd>2.25</dd>
        <dt>Lowest score <small>(Botswana)</small></dt>
        <dd>0.83</dd>
      </dl>

    {% endcase %}
  </div>

</div>

<div class="row--contained">

<script>

	var app = angular.module('countryApp2', [], function($interpolateProvider) {
    $interpolateProvider.startSymbol('//');
    $interpolateProvider.endSymbol('//');
  });
  
  app.controller('CountryListController2', ['$http', function($http) {
    _self = this;
    // Data
    this.countries = [];
    
    // Not a safe option. DEMO only.
    this.param_id = {{page.id}} - 1;
    
    // Sort related.
    this.sortField = 'overall_ranking';
    this.sortReverse = false;
    
    // Helper function.
    var getRequestUrl = function(regionId) {
      regionId = regionId || null;
      
      if (regionId == null) {
        return CS.domain + '/' + CS.lang + '/api/countries.json';
      }
      else {
        return CS.domain + '/' + CS.lang + '/api/regions/' + regionId + '.json';
      }
    };
    
    // Heler function used in html.
    this.setSort = function(field) {
      _self.sortField = field;
      _self.sortReverse = !_self.sortReverse;
    };
    
    this.getCountryUrl = function(country) {
      if (CS.countryIndex) {
        var iso = country.iso.toLowerCase();
        return CS.countryIndex[iso];
      }
      else {
        return '';
      }
    };
    
    this.getParameterValue = function(country) {
      return country.parameters[_self.param_id].value;
    };
    this.getParameterFieldName = function() {
      return 'parameters[' + _self.param_id + '].value';
    };
    
    // ---- Logic ----
    
    $http.get(getRequestUrl()).success(function(data) {
      _self.countries = data;
    });
        
  }]);
</script>

<div ng-app="countryApp2">
<div ng-controller="CountryListController2 as countryTable" ng-cloak>
  <table class="table">
    <thead>
      <tr>
        <th><a href="" ng-click="countryTable.setSort('overall_ranking')">Overall rank</a></th>
        <th><a href="" ng-click="countryTable.setSort('name')">Country</a></th>
        <th><a href="" ng-click="countryTable.setSort('score')">Overall score</a></th>
        <th><a href="" ng-click="countryTable.setSort(countryTable.getParameterFieldName())">Parameter</a></th>
        <th><a href="" ng-click="countryTable.setSort('grid')">Grid</a></th>
      </tr>
    </thead>
    <tbody ng-repeat="country in countryTable.countries | orderBy:countryTable.sortField:countryTable.sortReverse">
      <tr>
        <td>//country.overall_ranking//</td>
        <td>//country.name//</td>
        <td>//country.score//</td>
        <td>//countryTable.getParameterValue(country)//</td>
        <td>//country.grid//</td>
      </tr>
    </tbody>
  </table>
</div>
</div>





</div>
